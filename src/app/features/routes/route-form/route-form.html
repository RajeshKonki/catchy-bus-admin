<!-- Page Header -->
<div class="page-header">
    <h1>{{ isEditMode ? 'Edit Route' : 'Add New Route' }}</h1>
    <a routerLink="/routes" class="btn btn-ghost">
        <i class="fas fa-arrow-left"></i> Back to List
    </a>
</div>

<div *ngIf="loading" class="loading-state">
    <i class="fas fa-spinner fa-spin"></i> Loading...
</div>

<!-- Form Container -->
<div class="form-container" *ngIf="!loading">
    <div class="form-container-header">
        <i class="fas fa-route"></i>
        <h2>{{ isEditMode ? 'Update Route' : 'Create New Route' }}</h2>
    </div>

    <div class="form-body">
        <div *ngIf="error" class="error-alert">
            <i class="fas fa-exclamation-circle"></i> {{ error }}
        </div>

        <form [formGroup]="routeForm" (ngSubmit)="onSubmit()">
            <!-- Basic Info -->
            <div class="form-section-title">
                <i class="fas fa-info-circle"></i> Route Information
            </div>

            <div class="form-group">
                <label for="name">Route Name *</label>
                <input id="name" type="text" formControlName="name" class="form-control"
                    placeholder="e.g. Bangalore North Route">
                <div class="validation-error" *ngIf="routeForm.get('name')?.touched && routeForm.get('name')?.invalid">
                    Route name is required
                </div>
            </div>

            <div class="form-row">
                <div class="form-group col">
                    <label for="startPoint">Start Point *</label>
                    <input id="startPoint" type="text" formControlName="startPoint" class="form-control"
                        placeholder="e.g. Majestic Bus Stand">
                    <div class="validation-error"
                        *ngIf="routeForm.get('startPoint')?.touched && routeForm.get('startPoint')?.invalid">
                        Start point is required
                    </div>
                </div>
                <div class="form-group col">
                    <label for="endPoint">End Point *</label>
                    <input id="endPoint" type="text" formControlName="endPoint" class="form-control"
                        placeholder="e.g. Bangalore Institute of Technology">
                    <div class="validation-error"
                        *ngIf="routeForm.get('endPoint')?.touched && routeForm.get('endPoint')?.invalid">
                        End point is required
                    </div>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group col">
                    <label for="distance">Distance (km)</label>
                    <input id="distance" type="number" formControlName="distance" class="form-control"
                        placeholder="e.g. 12.5" step="0.1">
                </div>
                <div class="form-group col">
                    <label for="status">Status *</label>
                    <select id="status" formControlName="status" class="form-control">
                        <option value="Active">Active</option>
                        <option value="Inactive">Inactive</option>
                    </select>
                </div>
            </div>

            <!-- Stops -->
            <div class="form-section-title">
                <i class="fas fa-map-marker-alt"></i> Route Stops
            </div>

            <div class="form-group">
                <label>Stops (in order)</label>
                <div formArrayName="stops" class="stops-list">
                    <div *ngFor="let stop of stopsArray.controls; let i = index" class="stop-row">
                        <span class="stop-number">{{ i + 1 }}</span>
                        <input [formControlName]="i" type="text" class="form-control"
                            placeholder="Stop name, e.g. Shivajinagar">
                        <button type="button" (click)="removeStop(i)" class="btn btn-danger btn-icon">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                <button type="button" (click)="addStop()" class="btn btn-outline-primary add-stop-btn">
                    <i class="fas fa-plus"></i> Add Stop
                </button>
            </div>
        </form>
    </div>

    <div class="form-actions">
        <a routerLink="/routes" class="btn btn-ghost">Cancel</a>
        <button type="submit" class="btn btn-primary" [disabled]="routeForm.invalid || submitting" (click)="onSubmit()">
            <i class="fas fa-spinner fa-spin" *ngIf="submitting"></i>
            <i class="fas fa-save" *ngIf="!submitting"></i>
            {{ submitting ? 'Saving...' : (isEditMode ? 'Update Route' : 'Create Route') }}
        </button>
    </div>
</div>